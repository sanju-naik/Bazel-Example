load("@build_bazel_rules_ios//rules:framework.bzl", "apple_framework")

apple_framework(
    name = "nanopb",
    non_arc_srcs = glob([
        "*.h",
        "*.c",
        "pb.h",
        "pb_common.h",
        "pb_common.c",
        "pb_decode.h",
        "pb_decode.c",
        "pb_encode.h",
        "pb_encode.c",
    ]),
    platforms = {"ios": "9.0"},
    public_headers = [
        "pb.h",
        "pb_common.h",
        "pb_decode.h",
        "pb_encode.h",
    ],
    visibility = ["//visibility:public"],
    xcconfig = {"GCC_PREPROCESSOR_DEFINITIONS": [
        "PB_FIELD_32BIT=1",
        "PB_NO_PACKED_STRUCTS=1",
        "PB_ENABLE_MALLOC=1",
    ]},
)
